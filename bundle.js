!function(e){var t={};function s(i){if(t[i])return t[i].exports;var n=t[i]={i:i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=e,s.c=t,s.d=function(e,t,i){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)s.d(i,n,function(t){return e[t]}.bind(null,n));return i},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s(s.s=0)}([function(e,t,s){"use strict";var i;s.r(t),function(e){e.regular="regular",e.unexpected="unexpected",e.first="first",e.estate="estate",e.business="business"}(i||(i={}));class n{constructor(e,t){this.parentNode=e,this.type=t.type,this.index=t.index,this.month=t.month,t.title&&(this.title=t.title),this.render()}render(){this.rootNode=document.createElement("div"),this.rootNode.className="canvas-day",this.title&&(this.rootNode.innerHTML=this.title),this.rootNode.classList.add(this.getClassName()),this.parentNode.appendChild(this.rootNode)}getClassName(){return`canvas-day--${this.type}`}setActive(){this.rootNode.classList.add("canvas-day--active")}clearActive(){this.rootNode.classList.remove("canvas-day--active")}getIndexInMonth(){return this.index}getIndexInYear(){return 6*this.month.index+this.index}getMonth(){return this.month}isUnexpected(){return this.type===i.unexpected}isRegular(){return this.type===i.regular}isBusness(){return this.type===i.business}isEstate(){return this.type===i.estate}}class o{constructor(e,t){this.days=[],this.parentNode=e,this.shortName=t.shortName,this.index=t.index,this.renderRoot(),this.renderDays()}renderRoot(){this.rootNode=document.createElement("div"),this.rootNode.className="canvas-month",this.parentNode.appendChild(this.rootNode)}renderDays(){this.days.push(new n(this.rootNode,{index:0,month:this,title:this.shortName,type:i.first})),this.days.push(new n(this.rootNode,{index:1,month:this,type:i.business})),this.days.push(new n(this.rootNode,{index:2,month:this,type:i.unexpected})),this.days.push(new n(this.rootNode,{index:3,month:this,type:i.estate})),this.days.push(new n(this.rootNode,{index:4,month:this,type:i.unexpected})),this.days.push(new n(this.rootNode,{index:5,month:this,type:i.business})),this.days.push(new n(this.rootNode,{index:6,month:this,type:i.estate}))}getIndex(){return this.index}}const r=[{index:0,shortName:"Jan",fullName:"Jan"},{index:1,shortName:"Feb",fullName:"February"},{index:2,shortName:"Mar",fullName:"March"},{index:3,shortName:"Apr",fullName:"April"},{index:4,shortName:"May",fullName:"May"},{index:5,shortName:"Jun",fullName:"May"},{index:6,shortName:"Jul",fullName:"July"},{index:7,shortName:"Aug",fullName:"August"},{index:8,shortName:"Sep",fullName:"September"},{index:9,shortName:"Oct",fullName:"October"},{index:10,shortName:"Nov",fullName:"November"},{index:11,shortName:"Dec",fullName:"December"}];const a=(e,t)=>Math.floor(Math.random()*(t-e+1)+e),h=e=>e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,"."),d=(e,t)=>{return e*Math.round(t/100)};class l{constructor(e,t){this.renderSum=!1,this.rows=[],this.parentNode=e,this.title=t.title,this.className=t.className,this.rows=t.rows,t.renderSum&&(this.renderSum=t.renderSum),this.render()}render(){this.rootNode=document.createElement("div"),this.rootNode.className=`table ${this.className}`,this.renderHeader(),this.renderRows(),this.parentNode.appendChild(this.rootNode)}renderHeader(){this.headerNode=document.createElement("div"),this.headerNode.className="table-header",this.renderSum?this.headerNode.innerHTML=`${this.title} ${h(this.getSumm())}`:this.headerNode.innerHTML=`${this.title}`,this.rootNode.appendChild(this.headerNode)}updateSumm(){this.renderSum?this.headerNode.innerHTML=`${this.title} ${h(this.getSumm())}`:this.headerNode.innerHTML=`${this.title}`}renderRows(){this.rowsNode&&this.rowsNode.remove(),this.rowsNode=document.createElement("div"),this.rowsNode.className="table-rows",this.rows.forEach(e=>{const t=document.createElement("div");t.className="table-row";const s=document.createElement("div");s.className="table-row-title",s.innerText=e.title,t.appendChild(s);const i=document.createElement("div");i.className="table-row-value",Number.isInteger(e.value)?i.innerText=`${h(e.value)}`:i.innerText=e.value.toString(),t.appendChild(i),this.rowsNode.appendChild(t)}),this.rootNode.appendChild(this.rowsNode),this.updateSumm()}getSumm(){let e=0;return this.rows.forEach(t=>{e+=parseInt(t.value.toString(),10)}),e}updateRowValue(e,t){const s=this.rows.find(t=>t.id===e);s&&(s.value=t),this.renderRows()}update(e){this.rows=e,this.renderRows()}}var c;!function(e){e.warning="warning",e.success="success",e.regular="regular"}(c||(c={}));class u{constructor(e){this.description="",this.title=e.title,this.value=e.value,e.description&&(this.description=e.description)}getTitle(){return this.title}getDescription(){return this.description}getValue(){return this.value}}const g=[{title:"Украли ноутбук",value:4e4},{title:"Разбил телефон",value:5e3},{title:"Пригласили на ДР",value:2e3},{title:"Ремонт в квартире",value:1e4},{title:"Ремонт машины",value:7e3},{title:"Пригласили на сваьбу",value:5e3},{title:"Поход к стоматологу",value:4e3},{title:"Штраф за парковку",value:1e3},{title:"Поход к терапевту",value:2e3},{title:"Новый телефон",value:25e3},{title:"Покупка новой гитары",value:12e3},{title:"Поезка на море",value:2e4}];class m{constructor(e){this.title=e.title,this.cost=e.cost,this.earning=e.earning,this.id=e.id,this.img=e.img,this.description=e.description}getTitle(){return this.title}getDescription(){return`<b>${this.title}</b><br/>${this.description}<br/><br/>Цена ${h(this.cost)}<br/>Приносит в месяц ${h(this.earning)}<br/><br/><img src="src/images/${this.img}"/>`}getCost(){return this.cost}getEarning(){return this.earning}getId(){return this.id}}let p=[{id:"shava",title:"Ларек с веганской шавермой",description:"Фалафель, тофу, нори. Лучшая шавуха на районе.",img:"shava.jpg",cost:15e4,earning:1e4},{id:"smoozi",title:"Смузийная",description:"Смузи из фруктов, фреши, витграс.",img:"smoozi.jpg",cost:1e5,earning:5e3},{id:"barber",title:"Барбершоп",description:"Стрижка бороды, подкрутка усов, расчесывание волос.",img:"barber.jpg",cost:1e5,earning:15e3},{id:"burger",title:"Бургерная",description:"Бургеры с соевым мясом и хумусом. Румяные и хрустящие булочки.",img:"burger.jpg",cost:25e4,earning:2e4},{id:"coffee",title:"Кофейня",description:"Капучино, кофе с собой, холодный кофе, тортики и панкейки.",img:"coffee.jpg",cost:3e5,earning:25e3},{id:"public",title:"Паблик в VK",description:"Паблик Вконтакте с котиками.",img:"cat.jpg",cost:5e4,earning:5e3},{id:"giro",title:"Зарядка гироскутеров",description:"Экспресс зарядка гироскутеров. Эвакуирование, развал, схождение колес.",img:"giro.jpg",cost:8e4,earning:6e3},{id:"apl",title:"Магазин Эпл",description:"Макбуки, макфоны, макплееры.",img:"apl.jpg",cost:5e5,earning:3e4}];class v{static getRandomBusiness(){if(0===p.length)return null;const e=a(0,p.length-1);return new m(p[e])}static remove(e){p=p.filter(t=>t.id!==e)}}class N{constructor(e){this.description="",this.title=e.title,this.value=e.value,e.description&&(this.description=e.description)}getTitle(){return this.title}getDescription(){return this.description}getValue(){return this.value}}class y{constructor(e){this.title=e.title,this.cost=e.cost,this.earning=e.earning,this.id=e.id,this.img=e.img,this.description=e.description}getTitle(){return this.title}getDescription(){return`<b>${this.title}</b><br/>${this.description}<br/><br/>Цена ${h(this.cost)}<br/>Приносит в месяц ${h(this.earning)}<br/><br/><img src="src/images/${this.img}"/>`}getCost(){return this.cost}getEarning(){return this.earning}getId(){return this.id}}let w=[{id:"flat",title:"Однушка в Купчино",description:"Однушка для сдачи.",img:"flat.jpg",cost:1e6,earning:35e3},{id:"flat2",title:"Комната в коммуналке",description:"Комната в коммуналке для сдачи.",img:"flat2.jpg",cost:7e5,earning:25e3},{id:"flat3",title:"Комната в квартире",description:"Комната в квартире для сдачи.",img:"flat3.jpg",cost:12e5,earning:3e4},{id:"flat4",title:"Квартира",description:"Квартира для сдачи посуточно.",img:"flat4.jpg",cost:2e6,earning:5e4},{id:"flat5",title:"Хостел",description:"Хостел для сдачи туристам. Находится в центре города.",img:"flat5.jpg",cost:25e5,earning:75e3}];const b=new class{constructor(){this.days=[],this.months=[],this.activeDayIndex=0,this.northRegion=document.querySelector("#regionNorth"),this.regionOst=document.querySelector("#regionOst"),this.regionSouth=document.querySelector("#regionSouth"),this.regionWest=document.querySelector("#regionWest"),this.createMonths()}createMonths(){this.months.push(new o(this.northRegion,r[11])),this.months.push(new o(this.northRegion,r[0])),this.months.push(new o(this.northRegion,r[1])),this.months.push(new o(this.northRegion,r[2])),this.months.push(new o(this.regionOst,r[3])),this.months.push(new o(this.regionOst,r[4])),this.months.push(new o(this.regionSouth,r[5])),this.months.push(new o(this.regionSouth,r[6])),this.months.push(new o(this.regionSouth,r[7])),this.months.push(new o(this.regionSouth,r[8])),this.months.push(new o(this.regionWest,r[9])),this.months.push(new o(this.regionWest,r[10])),this.months.forEach(e=>{this.days.push(...e.days)})}setActiveDay(e){this.activeDayIndex=e,this.getDayByIndex(this.activeDayIndex).setActive()}clearActiveDay(e){this.getDayByIndex(e).clearActive()}getDayByIndex(e){return this.days[e]}getActiveDay(){return this.getDayByIndex(this.activeDayIndex)}getActiveMonth(){return this.getActiveDay().getMonth()}moveActiveDay(e,t){if(this.activeDayIndex===e)return;const s=setInterval(()=>{this.clearActiveDay(this.activeDayIndex),this.activeDayIndex+=1,this.activeDayIndex>=this.days.length&&(this.activeDayIndex=0),this.setActiveDay(this.activeDayIndex),0==(e-=1)&&(clearInterval(s),t())},100)}stop(){this.clearActiveDay(this.activeDayIndex)}};b.setActiveDay(7);const f=document.querySelector("#go");f&&f.addEventListener("click",()=>{I()}),document.addEventListener("keyup",e=>{32===e.keyCode&&I()});const C=document.querySelector("#root"),x=new class{constructor(e){this.parentNode=e,this.render()}render(){}renderEarnings(e){const t=[];Object.entries(e).forEach(([e,s])=>{t.push({id:e,title:s.title,value:s.value})});const s={className:"table--earning",title:"Доходы",renderSum:!0,rows:t};this.tableEarning?this.tableEarning.update(t):this.tableEarning=new l(this.parentNode,s)}renderCosts(e){const t=[];Object.entries(e).forEach(([e,s])=>{t.push({id:e,title:s.title,value:s.value})});const s={className:"table--costs",title:"Расходы",renderSum:!0,rows:t};this.tableCosts?this.tableCosts.update(t):this.tableCosts=new l(this.parentNode,s)}renderCommon(e,t,s,i){const n={className:"table--common",title:"Сводка",rows:[{id:"cash",title:"Наличность",value:e},{id:"cashFlow",title:"Денежный поток",value:t},{id:"monthsInGame",title:"Месяцев в игре",value:s},{id:"goal",title:"Цель накопить",value:i}]};this.tableCommon=new l(this.parentNode,n)}getTableCommon(){return this.tableCommon}}(C),E=new class{constructor(e){this.parentNode=e,this.render()}render(){this.rootNode=document.createElement("div"),this.rootNode.className="modal",this.renderHeader(),this.renderBody(),this.renderActions(),this.parentNode.appendChild(this.rootNode)}renderHeader(){this.headerNode=document.createElement("div"),this.headerNode.className="modal-header",this.rootNode.appendChild(this.headerNode)}renderBody(){this.bodyNode=document.createElement("div"),this.bodyNode.className="modal-body",this.rootNode.appendChild(this.bodyNode)}renderActions(){this.actionsNode=document.createElement("div"),this.actionsNode.className="modal-actions",this.rootNode.appendChild(this.actionsNode)}clear(){this.headerNode.innerHTML="",this.bodyNode.innerHTML="",this.actionsNode.innerHTML="",this.rootNode.classList.remove(c.warning),this.rootNode.classList.remove(c.success),this.rootNode.classList.remove(c.regular)}warn({title:e,message:t}){this.show({title:e,message:t,modifier:c.warning})}success({title:e,message:t}){this.show({title:e,message:t,modifier:c.success})}show({title:e,message:t,actions:s,modifier:i}){this.clear(),s&&s.length&&s.forEach(e=>{const t=document.createElement("button");t.className="modal-action",t.innerHTML=e.title,this.actionsNode.appendChild(t),t.addEventListener("click",e.callback)}),this.headerNode.innerHTML=e,this.bodyNode.innerHTML=t,i&&this.rootNode.classList.add(i)}}(C);E.show({title:"Начните игру",message:"Жмите кнопку Go и Go!"});const I=()=>{E.show({title:"Ходим дальше...",message:""});const e=a(1,6);b.moveActiveDay(e,()=>{M=b.getActiveMonth().getIndex(),T(),j(),D=M,S.isGoalAchieved()&&(E.show({title:"Победа!!!",message:"Цель по накоплению денег достигнута! Поздравляем вас."}),b.stop())})};let D=0,M=0;const S=new class{constructor({monthsInGame:e,cash:t,goal:s}){this.earnings={},this.costs={},this.monthsInGame=e,this.cash=t,this.goal=s}addMonthInGame(e){this.monthsInGame+=e}incomingPay(e){this.cash+=e}outgoingPay(e){this.cash-=e}getCash(){return this.cash}getCashFlow(){let e=0;Object.entries(this.earnings).forEach(([t,s])=>{e+=s.value});let t=0;return Object.entries(this.costs).forEach(([e,s])=>{t+=s.value}),e-t}getEarningValue(){let e=0;return Object.entries(this.earnings).forEach(([t,s])=>{e+=s.value}),e}getGoal(){return this.goal}getMonthsInGame(){return this.monthsInGame}isGoalAchieved(){return this.goal<=this.cash}addEarning(e,t){this.earnings[e]=t}getEarnings(){return this.earnings}setCost(e,t){this.costs[e]=t}getCosts(){return this.costs}hasEnoughCash(e){return this.cash>=e}}({monthsInGame:0,cash:5e4,goal:5e6});S.addEarning("salary",new N({title:"Работа",value:3e4})),S.setCost("car",new u({title:"Машина",value:3e3})),S.setCost("food",new u({title:"Корзина 30% от дохода",value:d(30,S.getEarningValue())})),S.setCost("rent",new u({title:"Аренда квартиры",value:7e3})),S.setCost("gym",new u({title:"Спорт зал",value:2e3})),x.renderCommon(S.getCash(),S.getCashFlow(),S.getMonthsInGame(),S.getGoal()),x.renderEarnings(S.getEarnings()),x.renderCosts(S.getCosts());const T=()=>{M!==D&&(S.incomingPay(S.getCashFlow()),S.addMonthInGame(1)),x.getTableCommon().updateRowValue("monthsInGame",S.getMonthsInGame()),x.getTableCommon().updateRowValue("cash",S.getCash()),x.getTableCommon().updateRowValue("cashFlow",S.getCashFlow())},j=()=>{const e=b.getActiveDay();if(e.isUnexpected()){const e=class{static getRandomCost(){const e=a(0,g.length-1);return new u(g[e])}}.getRandomCost();E.warn({title:"Незапланированные расходы",message:`${e.getTitle()} уносит <b>${h(e.getValue())}</b><br/><br/><img src="src/images/pain.jpg"/>`}),S.outgoingPay(e.getValue()),x.getTableCommon().updateRowValue("cash",S.getCash()),S.getCash()<0&&(E.warn({title:"Это фиаско, братан!",message:"Вы банкрот, нет наличности, игра проиграна."}),b.stop())}if(e.isBusness()){const e=v.getRandomBusiness();if(!e)return void E.show({title:"Нет бизнеса для покупки",message:"Вы скупили все бизнесы на районе."});if(!S.hasEnoughCash(e.getCost()))return void E.show({title:"Недостаточно денег на покупку",message:e.getDescription()});E.show({title:"Хотите купить бизнес?",message:e.getDescription(),actions:[{title:"Купить!",callback:()=>{S.hasEnoughCash(e.getCost())&&(E.success({title:"Вы купили новый бизнес!",message:`${e.getTitle()} приносит +${h(e.getEarning())} в месяц.<br/><br/><img src="src/images/success.jpg"/>`}),S.addEarning(e.getId(),new N({title:e.getTitle(),value:e.getEarning()})),S.outgoingPay(e.getCost()),S.setCost("food",new u({title:"Корзина 30% от дохода",value:d(30,S.getEarningValue())})),x.renderCosts(S.getCosts()),x.renderEarnings(S.getEarnings()),x.getTableCommon().updateRowValue("cashFlow",S.getCashFlow()),x.getTableCommon().updateRowValue("cash",S.getCash()),v.remove(e.getId()))}}]})}if(e.isEstate()){const e=class{static getRandomEstate(){if(0===w.length)return null;const e=a(0,w.length-1);return new y(w[e])}static remove(e){w=w.filter(t=>t.id!==e)}}.getRandomEstate();if(!e)return void E.show({title:"Нет недвижимости для покупки",message:"Вы скупили всю недвижимость на районе."});if(!S.hasEnoughCash(e.getCost()))return void E.show({title:"Недостаточно денег на покупку",message:e.getDescription()});E.show({title:"Хотите купить недвижимость?",message:e.getDescription(),actions:[{title:"Купить!",callback:()=>{S.hasEnoughCash(e.getCost())&&(E.success({title:"Вы купили новую недвижимость!",message:`${e.getTitle()} приносит +${h(e.getEarning())} в месяц.<br/><br/><img src="src/images/success.jpg"/>`}),S.addEarning(e.getId(),new N({title:e.getTitle(),value:e.getEarning()})),S.outgoingPay(e.getCost()),S.setCost("food",new u({title:"Корзина 30% от дохода",value:d(30,S.getEarningValue())})),x.renderCosts(S.getCosts()),x.renderEarnings(S.getEarnings()),x.getTableCommon().updateRowValue("cashFlow",S.getCashFlow()),x.getTableCommon().updateRowValue("cash",S.getCash()),v.remove(e.getId()))}}]})}e.isRegular()&&E.show({title:"Новый день",message:"Вы попали на пустое поле."})}}]);